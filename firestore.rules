// Firebase Firestore Security Rules for Growtez Blog
// Copy these rules to: Firebase Console > Firestore Database > Rules

rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Blog Posts Collection
    match /blog_posts/{postId} {
      // Anyone can READ any blog post (the query filters by isPublished)
      allow read: if true;

      // Authenticated admins can write
      allow write: if request.auth != null 
                   && (request.auth.token.email == "contact@growtez.com"
                       || request.auth.token.email == "contact.growtez@gmail.com"
                       || request.auth.token.email == "exkrogroup@gmail.com"
                       || request.auth.token.email == "souravsharma13here@gmail.com"
                       || request.auth.token.email == "mridulroy543@gmail.com"
                       || request.auth.token.email == "faruk.khan.cse@gmail.com"
                       || request.auth.token.email == "ahmedsanjeev37@gmail.com");
    }

    // Deny access to all other collections by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
